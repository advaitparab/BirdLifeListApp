<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Home</title>
    <style>
        body { font-family: system-ui, Arial, sans-serif; margin: 2rem; }
        nav a { margin-right: 1rem; }
        table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
        th, td { border: 1px solid #e5e5e5; padding: .5rem .6rem; text-align: left; }
        th { background: #fafafa; }
        .alert { padding:.75rem 1rem; background:#fff8e1; border:1px solid #ddd; margin:1rem 0; }
    </style>
</head>
<body>
<nav>
    <a th:href="@{/home}">Home</a>
    <a th:href="@{/myWaypoints}">My Winged Waypoints</a>
</nav>

<h1>Home</h1>

<!-- show friendly error if repo/service threw -->
<div class="alert" th:if="${loadError}">
    Could not load birds. <small th:text="${loadError}">details</small>
</div>

<form method="get" th:action="@{/home}">
    <!--<label>Query <input type="text" name="q" th:value="${q}"></label>
    <label>Color <input type="text" name="color" th:value="${color}"></label>
    <label>Location <input type="text" name="location" th:value="${location}"></label>
    <button type="submit">Search</button>-->


        <!-- Search -->
        <input type="text" name="q" placeholder="Search birds..." th:value="${q}"/>

        <!-- Color Filter --> <!--need to add a list of selectable colors-->
        <select name="color" onchange="this.form.submit()">
            <option value="">Color</option>
            <option th:each="color : ${colors}"
                    th:value="${color}"
                    th:text="${color}"
                    th:selected="${color == selectedColor}">
            </option>
        </select>

        <!-- Location Filter--> <!--need to add a list of selectable locations-->
        <select name="location" onchange="this.form.submit()">
            <option value="">Location</option>
            <option th:each="loc : ${locations}"
                    th:value="${loc}"
                    th:text="${loc}"
                    th:selected="${loc == selectedLocation}">
            </option>
        </select>

        <button type="submit">Search</button>

</form>

<table th:if="${birds != null}">
    <thead>
    <tr>
        <th>ID</th>
        <th>Common Name</th>
        <th>Species</th>
        <th>Color</th>
        <th>Default Location</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="bird : ${birds}">
        <td th:text="${bird.birdId}">1</td>
        <td th:text="${bird.commonName}">Blue Jay</td>
        <td th:text="${bird.speciesName}">Cyanocitta cristata</td>
        <td th:text="${bird.color}">Blue</td>
        <td th:text="${bird.defaultLocation}">Ohio</td>
        <td>
            <a th:href="@{'/birds/details/' + ${bird.birdId}}">Details</a>

            <!--<form method="post" th:action="@{'/birds/add/' + ${bird.birdId}}" style="display:inline">
                <button type="submit">Add</button>
            </form>-->
            <form th:action="@{'/mylist/add/' + ${bird.birdId}}" method="post">
                <button type="submit">Add</button>
            </form>

        </td>
    </tr>
    </tbody>
</table>

<p th:if="${birds != null and #lists.isEmpty(birds)}">No birds found.</p>
</body>
</html>
