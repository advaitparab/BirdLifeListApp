<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>My Winged Waypoints</title>

    <style>
        body { font-family: system-ui, Arial, sans-serif; margin: 2rem; }
        nav a { margin-right: 1rem; }
        table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
        th, td { border: 1px solid #e5e5e5; padding: .5rem .6rem; text-align: left; }
        th { background: #fafafa; }
        .alert { padding:.75rem 1rem; background:#fff8e1; border:1px solid #ddd; margin:1rem 0; }
    </style>

</head>

<body>

    <!-- Navigation -->
    <nav>
        <a href="/home">Home</a>
        <a href="/myWaypoints">My Winged Waypoints</a>
    </nav>

    <!-- Header -->
    <h1>My Winged Waypoints</h1>

    <!-- show friendly error if repo/service threw -->
    <div class="alert" th:if="${loadError}">
        Could not load birds. <small th:text="${loadError}">details</small>
    </div>

    <form method="get" th:action="@{/myWaypoints}">

        <!-- Search -->
        <input type="text" name="q" placeholder="Search birds..." th:value="${q}"/>

        <!-- Color Filter --> <!--need to add a list of selectable colors-->
        <select name="color" onchange="this.form.submit()">
            <option value="">Color</option>
            <option th:each="color : ${colors}"
                    th:value="${color}"
                    th:text="${color}"
                    th:selected="${color == selectedColor}">
            </option>
        </select>

        <!-- Location Filter--> <!--need to add a list of selectable locations-->
        <select name="location" onchange="this.form.submit()">
            <option value="">Location</option>
            <option th:each="loc : ${locations}"
                    th:value="${loc}"
                    th:text="${loc}"
                    th:selected="${loc == selectedLocation}">
            </option>
        </select>

        <button type="submit">Search</button>

    </form>

    <!-- Bird List -->
    <table th:if="${waypoints != null}">
        <thead>
        <tr>
            <th>ID</th>
            <th>Common Name</th>
            <th>Species</th>
            <th>Color</th>
            <th>Default Location</th>
            <th>Date Seen</th>
            <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="bird : ${waypoints}">
            <td th:text="${bird.birdId}">1</td>
            <td th:text="${bird.commonName}">Blue Jay</td>
            <td th:text="${bird.speciesName}">Cyanocitta cristata</td>
            <td th:text="${bird.color}">Blue</td>
            <td th:text="${bird.defaultLocation}">Ohio</td>
            <td th:text="${entry.dateSeen}">2025-11-17</td>
            <td>
                <a th:href="@{'/birds/details/' + ${bird.birdId}}">Details</a>

                <!--<form method="post" th:action="@{'/birds/add/' + ${bird.birdId}}" style="display:inline">
                    <button type="submit">Add</button>
                </form>-->
                <form th:action="@{'/mylist/remove/' + ${bird.birdId}}" method="post" style="display:inline">
                    <button type="submit">Delete</button>
                </form>

            </td>
        </tr>
        </tbody>
    </table>

    <p th:if="${birds != null and #lists.isEmpty(birds)}">No birds found.</p>
</body>
</html>


